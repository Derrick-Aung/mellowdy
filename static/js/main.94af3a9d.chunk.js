(this.webpackJsonpmellowdy=this.webpackJsonpmellowdy||[]).push([[0],{43:function(t,e,a){t.exports=a(87)},48:function(t,e,a){},49:function(t,e,a){},87:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),s=a(19),c=a.n(s),i=(a(48),a(7)),o=a(8),l=a(11),u=a(9),h=a(12),m=(a(49),a(22)),p=a(88),d=a(89),k=a(90),b=a(91),f=a(92),y=a(93),g=a(94),v=a(10);var T=a(3),E=a.n(T),_="https://accounts.spotify.com/authorize",O=["user-read-recently-played","user-top-read","user-library-modify","user-library-read","playlist-modify-public"],j="https://api.spotify.com/v1/",A=function(t){return"https://api.spotify.com/v1/me/tracks?ids=".concat(t)},C=function(t,e){return"https://api.spotify.com/v1/playlists/".concat(t,"/tracks?uris=").concat(e)},I=function(t){return"https://api.spotify.com/v1/albums/".concat(t)},N="e4cea7caa08242babef9202eda8e472f",w="https://derrick-aung.github.io/mellowdy";function S(t){return function(e){var a="".concat(j,"me/player/recently-played?limit=50");E.a.get(a,{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){var a=t.data.items.map((function(t){return t.track}));e({type:"FETCH_RECENTLY_PLAYED",recentlyPlayedSongs:a})}))}}var P=window.location.hash.substring(1).split("&").reduce((function(t,e){if(e){var a=e.split("=");t[a[0]]=decodeURIComponent(a[1])}return t}),{}),F=Object(v.b)((function(t){return{token:t.auth.token,id:t.general.id}}),{setToken:function(t){return{type:"SET_TOKEN",token:t}},getUserProfileId:function(t){return function(e){var a="".concat(j,"me");E.a.get(a,{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){var a=t.data.id;e({type:"SET_USER_ID",user_id:a})}))}},getUserPlaylists:function(t,e){return function(a){var n=function(t){return"https://api.spotify.com/v1/users/".concat(t,"/playlists")}(t);E.a.get(n,{headers:{Authorization:"Bearer ".concat(e)}}).then((function(t){var e=t.data.items;a({type:"FETCH_USER_PLAYLISTS",user_playlists:e})}))}}})((function(t){var e=Object(n.useState)(!0),a=Object(m.a)(e,2),s=a[0],c=a[1];return Object(n.useEffect)((function(){var e=P.access_token;t.setToken(e),window.location.hash=""}),[]),Object(n.useEffect)((function(){t.getUserProfileId(t.token)}),[t.token]),Object(n.useEffect)((function(){t.getUserPlaylists(t.id,t.token)}),[t.token,t.id]),r.a.createElement("div",null,r.a.createElement(p.a,{dark:!0},r.a.createElement(d.a,{href:"#",className:"mr-auto"},r.a.createElement("img",{className:"mellowdy-logo",src:"/mellowdy/redfox.png",alt:""}),"Mellowdy | Discover yourself"),r.a.createElement(k.a,{onClick:function(){return c(!s)},className:"mr-2"}),r.a.createElement(b.a,{isOpen:!s,navbar:!0},r.a.createElement(f.a,{navbar:!0},r.a.createElement(y.a,null,t.token?r.a.createElement(g.a,{href:w},"Logout"):r.a.createElement(g.a,{href:"".concat(_,"?client_id=").concat(N,"&redirect_uri=").concat(w,"&response_type=token&show_dialog=true&scope=").concat(O.join("%20"))},"Login With Spotify")),r.a.createElement(y.a,null,r.a.createElement(g.a,{href:"https://github.com/Derrick-Aung/mellowdy"},"GitHub"))))))})),L=a(14),R=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).handleClick=function(){a.props.setIsFetching(!0),a.props.changeTab(a.props.name)},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement("span",{className:"tag",onClick:this.handleClick},this.props.name?this.props.name:"Default")}}]),e}(n.Component);function D(t){return r.a.createElement("div",{className:"tag-container"},r.a.createElement(R,{name:"Charts",changeTab:t.changeTab,setIsFetching:t.setIsFetching}),r.a.createElement(R,{name:"Recently Played",changeTab:t.changeTab,setIsFetching:t.setIsFetching}),r.a.createElement(R,{name:"Your Top Tracks",changeTab:t.changeTab,setIsFetching:t.setIsFetching}))}var M=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={dataReady:!1,currentDisplay:null},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){if(this.props.isFetching){switch(this.props.currentTab){case"Recently Played":this.props.fetchRecentlyPlayed(this.props.token);break;case"Your Top Tracks":this.props.fetchUserTopTracks(this.props.token);break;case"Charts":this.props.fetchCharts(this.props.token);break;default:this.props.fetchGenre(this.props.token,this.props.currentTab)}this.props.setIsFetching(!1)}else switch(this.props.currentTab){case"Recently Played":this.props.recentlyPlayed;break;case"Your Top Tracks":this.props.userTopTracks;break;case"Charts":this.props.charts;break;default:this.props.genreTracks}}},{key:"componentDidUpdate",value:function(t,e){var a=null;if(this.props.isFetching){switch(this.props.currentTab){case"Recently Played":this.props.fetchRecentlyPlayed(this.props.token);break;case"Your Top Tracks":this.props.fetchUserTopTracks(this.props.token);break;case"Charts":this.props.fetchCharts(this.props.token);break;default:this.props.fetchGenre(this.props.token,this.props.currentTab)}this.props.setIsFetching(!1)}else{switch(this.props.currentTab){case"Recently Played":a=this.props.recentlyPlayed;break;case"Your Top Tracks":a=this.props.userTopTracks;break;case"Charts":a=this.props.charts;break;default:a=this.props.genreTracks}e.currentDisplay!==a&&this.setState({currentDisplay:a})}}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"primary-container mb-4"},r.a.createElement("div",null,r.a.createElement("h2",null,this.props.currentTab),!this.props.isFetching&&this.state.currentDisplay&&r.a.createElement("div",{className:"grid-container my-4"},this.state.currentDisplay.filter((function(t){return t.preview_url})).map((function(e,a){return r.a.createElement("div",{className:"song-container",key:a},r.a.createElement("img",{onClick:function(){return t.props.handleTrackClick(e.id,e.preview_url,e.artists[0].id,e.album.id)},src:e.album.images[0].url,alt:""}))})))))}}]),e}(n.Component),B={fetchRecentlyPlayed:S,fetchUserTopTracks:function(t){return function(e){var a="".concat(j,"me/top/tracks?limit=50");E.a.get(a,{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){e({type:"FETCH_USER_TOP_TRACKS",userTopTracks:t.data.items})}))}},fetchCharts:function(t){return function(e){var a="".concat(j,"playlists/37i9dQZEVXbMDoHDwVN2tF");E.a.get(a,{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){var a=t.data.tracks.items.map((function(t){return t.track}));e({type:"FETCH_CHARTS",charts:a})}))}},fetchGenre:function(t,e){return function(a){var n=function(t){var e=escape('genre:"'.concat(t,'"'));return"https://api.spotify.com/v1/search?query=".concat(e,"&type=track&limit=50")}(e);E.a.get(n,{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){var e=t.data.tracks.items;a({type:"FETCH_GENRE_TRACKS",genre_tracks:e})}))}}},U=Object(v.b)((function(t){return{token:t.auth.token,recentlyPlayed:t.melodies.recently_played_songs,userTopTracks:t.melodies.user_top_tracks,charts:t.melodies.charts,genreTracks:t.melodies.genre_tracks}}),B)(M),z=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={artist_top_tracks:null,artist_albums:null,artist:null},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getArtistTopTracks",value:function(t){var e,a=this;E.a.get((e=t,"https://api.spotify.com/v1/artists/".concat(e,"/top-tracks?country=from_token")),{headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){a.setState({artist_top_tracks:t.data})}))}},{key:"getArtistAlbums",value:function(t){var e=this;E.a.get(function(t){return"https://api.spotify.com/v1/artists/".concat(t,"/albums?include_groups=album,single&limit=20")}(t),{headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){e.setState({artist_albums:t.data.items})}))}},{key:"getArtistDetails",value:function(t){var e=this;E.a.get(function(t){return"https://api.spotify.com/v1/artists/".concat(t)}(t),{headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){e.setState({artist:t.data})}))}},{key:"playAlbum",value:function(t){var e=this;E()({method:"get",url:I(t),headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){var a=t.data;e.props.handleTrackClick(a.tracks.items[0].id,a.tracks.items[0].preview_url,a.artists[0].id,a.id)}))}},{key:"componentDidUpdate",value:function(t,e){if(t.currentArtistId!==this.props.currentArtistId){var a=this.props.currentArtistId;this.getArtistDetails(a),this.getArtistTopTracks(a),this.getArtistAlbums(a)}}},{key:"render",value:function(){var t=this;return this.state.artist&&this.state.artist_albums&&this.state.artist_top_tracks?r.a.createElement("div",{className:"artist-container"},r.a.createElement("div",null,r.a.createElement("div",{className:"artist-details"},r.a.createElement("div",{className:"artist-img"},r.a.createElement("img",{src:this.state.artist.images[0]?this.state.artist.images[0].url:"",alt:""})),r.a.createElement("div",{className:"artist-info"},r.a.createElement("span",null,this.state.artist.name),r.a.createElement("div",{className:"my-2"},r.a.createElement("span",null,this.state.artist.genres.map((function(e,a){return r.a.createElement("span",{className:"clickable genre",key:"genre-".concat(a),onClick:function(){return t.props.setGenre(e)}},e)})))),r.a.createElement("span",{className:"muted-text-light"},this.state.artist.followers.total," followers"))),r.a.createElement("div",{className:"top-tracks"},r.a.createElement("span",null,"Top Tracks"),r.a.createElement("div",{className:"song-container"},this.state.artist_top_tracks.tracks.filter((function(t){return t.preview_url})).map((function(e,a){return r.a.createElement("img",{key:"track-".concat(a),onClick:function(){return t.props.handleTrackClick(e.id,e.preview_url,e.artists[0].id,e.album.id)},src:e.album.images[0].url,alt:""})})))),r.a.createElement("div",{className:"top-tracks"},r.a.createElement("span",null,"Albums"),r.a.createElement("div",{className:"song-container"},this.state.artist_albums.filter((function(t){return"album"===t.album_group})).map((function(e,a){return r.a.createElement("img",{key:"album-".concat(a),onClick:function(){return t.playAlbum(e.id)},src:e.images[0].url,alt:""})})))),r.a.createElement("div",{className:"top-tracks"},r.a.createElement("span",null,"Single"),r.a.createElement("div",{className:"song-container"},this.state.artist_albums.filter((function(t){return"single"===t.album_group})).map((function(e,a){return r.a.createElement("img",{key:"single-".concat(a),onClick:function(){return t.playAlbum(e.id)},src:e.images[0].url,alt:""})})))))):null}}]),e}(n.Component),H=Object(v.b)((function(t){return{token:t.auth.token}}))(z);function G(t){return r.a.createElement("span",{className:"add-button mx-2",onClick:function(){return t.addTrackToLib()}},t.trackInLibrary?r.a.createElement("i",{className:"fas fa-check"}):r.a.createElement("i",{className:"fas fa-plus"}))}var x=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={showMenu:!1},a.showMenu=a.showMenu.bind(Object(L.a)(a)),a.closeMenu=a.closeMenu.bind(Object(L.a)(a)),a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"showMenu",value:function(t){var e=this;t.preventDefault(),this.setState({showMenu:!0},(function(){document.addEventListener("click",e.closeMenu)}))}},{key:"closeMenu",value:function(t){var e=this;this.dropdownMenu.contains(t.target)||this.setState({showMenu:!1},(function(){document.removeEventListener("click",e.closeMenu)}))}},{key:"render",value:function(){var t=this;return r.a.createElement("span",{className:"add-button mx-2",onClick:this.showMenu},r.a.createElement("i",{className:"fas fa-list"}),this.state.showMenu?r.a.createElement("div",{className:"playlist-menu",ref:function(e){t.dropdownMenu=e}},this.props.user_playlists.map((function(e){return r.a.createElement("button",{key:e.id,onClick:function(){return t.props.addTrackToPlaylist(e.id)}},"+ ".concat(e.name))}))):null)}}]),e}(n.Component),Y=Object(v.b)((function(t){return{user_playlists:t.melodies.user_playlists}}))(x),K=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={track_id:null,track:null},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"getTrack",value:function(t){var e=this;E.a.get(function(t){return"https://api.spotify.com/v1/tracks/".concat(t)}(t),{headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){e.setState({track:t.data})}))}},{key:"componentDidUpdate",value:function(t,e){t.currentTrackId!==this.props.currentTrackId&&this.getTrack(this.props.currentTrackId)}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.track&&r.a.createElement("div",{className:"details-container"},r.a.createElement("div",null,r.a.createElement("div",{className:"details-main-img"},r.a.createElement("img",{src:this.state.track.album.images[0].url,alt:""}),r.a.createElement("div",{className:"add-buttons"},r.a.createElement(G,{addTrackToLib:this.props.addTrackToLib,trackInLibrary:this.props.trackInLibrary}),r.a.createElement(Y,{addTrackToPlaylist:this.props.addTrackToPlaylist}))),r.a.createElement("div",{className:"details-info"},r.a.createElement("div",null,r.a.createElement("span",{className:"song-title-text"},this.state.track.name),r.a.createElement("span",{className:"muted-text"},this.state.track.artists.map((function(t){return t.name})).join(" & ")),r.a.createElement("span",{className:"muted-text"},"From the album ".concat(this.state.track.album.name)))))))}}]),e}(n.Component),W=Object(v.b)((function(t){return{token:t.auth.token}}))(K),J=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={album:null},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(t,e){var a=this;if(t.currentAlbumId!==this.props.currentAlbumId){var n=this.props.currentAlbumId;E()({method:"get",url:I(n),headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){a.setState({album:t.data})}))}}},{key:"render",value:function(){var t=this;return this.state.album?r.a.createElement("div",{className:"album-container"},r.a.createElement("div",null,r.a.createElement("div",{className:"album-details"},r.a.createElement("div",{className:"album-img"},r.a.createElement("img",{src:this.state.album.images[1].url,alt:""})),r.a.createElement("div",{className:"album-info"},r.a.createElement("span",null,this.state.album.name),r.a.createElement("span",{className:"muted-text-light"},"By ",this.state.album.artists[0].name),r.a.createElement("span",{className:"muted-text-light"},"Released ",this.state.album.release_date))),r.a.createElement("div",{className:"album-tracks"},r.a.createElement("span",null,"Tracks"),r.a.createElement("div",{className:"track-list-container"},this.state.album.tracks.items.filter((function(t){return t.preview_url})).map((function(e,a){return r.a.createElement("div",{className:"album-track mt-1",key:a},r.a.createElement("img",{onClick:function(){return t.props.handleTrackClick(e.id,e.preview_url,t.state.album.artists[0].id,t.state.album.id)},src:t.state.album.images[1].url,alt:""}),r.a.createElement("span",{className:"ml-3"},e.name))})))))):null}}]),e}(n.Component),V=Object(v.b)((function(t){return{token:t.auth.token}}))(J),q=a(95),Q=function(t){var e=Object(n.useState)(!0),a=Object(m.a)(e,2),s=a[0],c=a[1];return r.a.createElement(q.a,{className:"mt-3",color:"success",isOpen:s,toggle:function(){return c(!1)}},"Sound warning! Dive in and start listening by clicking on the boxes below.")},X=function(t){function e(){var t;return Object(i.a)(this,e),(t=Object(l.a)(this,Object(u.a)(e).call(this))).state={showOnlyPlayable:!0,dataReady:!0,isFetching:!0,songPlaying:!1,audio:null,currentTab:"Charts",trackInLibrary:!1,currentArtistId:null,currentAlbumId:null,currentTrackId:null,currentGenre:null},t.handleTrackClick=t.handleTrackClick.bind(Object(L.a)(t)),t.changeTab=t.changeTab.bind(Object(L.a)(t)),t.setIsFetching=t.setIsFetching.bind(Object(L.a)(t)),t.addTrackToLib=t.addTrackToLib.bind(Object(L.a)(t)),t.addTrackToPlaylist=t.addTrackToPlaylist.bind(Object(L.a)(t)),t.setGenre=t.setGenre.bind(Object(L.a)(t)),t}return Object(h.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){}},{key:"fetchAudioAndDetails",value:function(){}},{key:"checkTrackInLib",value:function(t){var e=this;E.a.get(function(t){return"https://api.spotify.com/v1/me/tracks/contains?ids=".concat(t)}(t),{headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(t){var a=t.data[0];e.setState({trackInLibrary:a})}))}},{key:"handleTrackClick",value:function(t,e,a,n){var r=new Audio(e);this.state.songPlaying?this.state.currentTrackId==t?(this.state.audio.pause(),this.setState({songPlaying:!1})):(this.state.audio.pause(),r.play(),this.setState({songPlaying:!0,currentAlbumId:n,currentArtistId:a,currentTrackId:t,audio:r})):(r.play(),this.setState({songPlaying:!0,currentAlbumId:n,currentArtistId:a,currentTrackId:t,audio:r})),this.checkTrackInLib(t)}},{key:"changeTab",value:function(t){this.setState({currentTab:t})}},{key:"setGenre",value:function(t){this.setState({currentGenre:t,currentTab:t,isFetching:!0})}},{key:"setIsFetching",value:function(t){this.setState({isFetching:t})}},{key:"addTrackToLib",value:function(){var t=this.state.currentTrackId;E()({method:"put",url:A(t),headers:{Authorization:"Bearer ".concat(this.props.token)}}).then(this.setState({trackInLibrary:!0}))}},{key:"addTrackToPlaylist",value:function(t){var e,a=(e=this.state.currentTrackId,"spotify:track:".concat(e));E()({method:"post",url:C(t,a),headers:{Authorization:"Bearer ".concat(this.props.token),"Content-Type":"application/json"}}).then(console.log("Added track to playlist"))}},{key:"render",value:function(){return this.props&&this.props.token?r.a.createElement("div",null,r.a.createElement(D,{changeTab:this.changeTab,setIsFetching:this.setIsFetching}),r.a.createElement(Q,null),r.a.createElement("div",{className:"main-container"},r.a.createElement(U,{isFetching:this.state.isFetching,setIsFetching:this.setIsFetching,currentTab:this.state.currentTab,handleTrackClick:this.handleTrackClick}),r.a.createElement(W,{currentTrackId:this.state.currentTrackId,addTrackToLib:this.addTrackToLib,addTrackToPlaylist:this.addTrackToPlaylist,trackInLibrary:this.state.trackInLibrary})),r.a.createElement(H,{currentArtistId:this.state.currentArtistId,handleTrackClick:this.handleTrackClick,playAlbum:this.playAlbum,setGenre:this.setGenre}),r.a.createElement(V,{currentAlbumId:this.state.currentAlbumId,handleTrackClick:this.handleTrackClick})):r.a.createElement("div",{className:"login-container"},r.a.createElement("span",null,"The new way to discover music feat. The Spotify API"),r.a.createElement("br",null),r.a.createElement("span",{className:"muted-text"},"A web project by Aung Phone Khant (Derrick)"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",{className:"muted-text"},"Note: This is for only for big screens as it is an ongoing project"),r.a.createElement("div",null,r.a.createElement("span",{className:"tag mt-3"},r.a.createElement("a",{href:"".concat(_,"?client_id=").concat(N,"&redirect_uri=").concat(w,"&response_type=token&show_dialog=true&scope=").concat(O.join("%20"))},"Login To Spotify First"))))}}]),e}(n.Component),Z={fetchRecentlyPlayed:S},$=Object(v.b)((function(t){return{token:t.auth.token,recentlyPlayed:t.melodies.recently_played_songs}}),Z)(X),tt=a(17),et=a(41),at=a(15),nt={recently_played_songs:[]},rt={token:null},st={id:null},ct=Object(tt.c)({auth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_TOKEN":return Object(at.a)({},t,{token:e.token});default:return t}},melodies:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"FETCH_RECENTLY_PLAYED":return Object(at.a)({},t,{recently_played_songs:e.recentlyPlayedSongs});case"FETCH_USER_TOP_TRACKS":return Object(at.a)({},t,{user_top_tracks:e.userTopTracks});case"FETCH_CHARTS":case"FETCH_CHARTS":return Object(at.a)({},t,{charts:e.charts});case"FETCH_USER_PLAYLISTS":return Object(at.a)({},t,{user_playlists:e.user_playlists});case"FETCH_GENRE_TRACKS":return Object(at.a)({},t,{genre_tracks:e.genre_tracks});default:return t}},general:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_USER_ID":return Object(at.a)({},t,{id:e.user_id});default:return t}}}),it=[et.a],ot=Object(tt.e)(ct,{},Object(tt.d)(tt.a.apply(void 0,it))),lt=function(t){function e(){return Object(i.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement(v.a,{store:ot},r.a.createElement("div",{className:"App"},r.a.createElement(F,null),r.a.createElement($,null)))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(86);c.a.render(r.a.createElement(lt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.94af3a9d.chunk.js.map